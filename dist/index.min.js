"use strict";var _createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Promise=t()}(void 0,function(){var u=!1;function f(e){if("function"==typeof e||"object"==(void 0===e?"undefined":_typeof(e))&&null!=e)try{var t=e.then;if(t&&"function"==typeof t)return t}catch(e){return{throwed:e}}return!1}function s(e){return new Error("Uncaught (in promise) "+e)}var a=function(){function c(e){var t=this;if(_classCallCheck(this,c),"function"!=typeof e)throw new Error("need 1 argument and it should be a function");this._decideLock="locked";var n=!(this._retrivers=[]),i=!1,r="pending",o=void 0;Object.defineProperties(this,{_PromiseStatus:{get:function(){return r},set:function(e){var t=this;return"locked"!=this._decideLock&&(!n&&void("pending"==r&&"pending"!=e&&(n=!0,r=e,setTimeout(function(){if(t._onStatusChange(e),0==t._retrivers.length&&"rejected"==t._PromiseStatus&&!u)throw s(t._PromiseValue)}))))}},_PromiseValue:{get:function(){return o},set:function(e){return"locked"!=this._decideLock&&(!i&&(i=!0,void(o=e)))}}});try{e(function(e){t._decide("fufilled",e)},function(e){t._decide("rejected",e)})}catch(e){throw s(e)}}return _createClass(c,[{key:"_decide",value:function(e,t){this._decideLock="unlock",this._PromiseValue=t,this._PromiseStatus=e,this._decideLock="locked"}},{key:"_onStatusChange",value:function(e){for(;0<this._retrivers.length;){var t=this._retrivers.shift();try{var n=void 0;if("fufilled"==e)n=t.onFufilled?t.onFufilled.call(void 0,this._PromiseValue):this._PromiseValue;else if("rejected"==e){if(!t.onRejected){if(this._PromiseValue instanceof Error)throw this._PromiseValue;this._reject(t.promise2,this._PromiseValue);continue}n=t.onRejected.call(void 0,this._PromiseValue)}this._resolve(t.promise2,n)}catch(e){this._reject(t.promise2,e)}}}},{key:"_resolve",value:function(n,e,t){var i=this,r=f(e);if(r.throwed)throw r.throwed;if(n==e&&this._reject(n,new TypeError("as [[Resolve]](promise, x) defined, promise === x is wrong")),e instanceof c)"pending"==e._PromiseStatus?e.then(function(e){var t=f(e);if(t.throwed)n._decide("rejected",t.throwed);else if(t)try{t.call(e,function(e){n._decide("fufilled",e)},function(e){n._decide("rejected",e)})}catch(e){n._decide("rejected",e)}else n._decide("fufilled",e)},function(e){n._decide("rejected",e)}):"fufilled"==e._PromiseStatus?this._resolve(n,e._PromiseValue):"rejected"==e._PromiseStatus&&(e._PromiseValue instanceof c?this._resolve(n,e._PromiseValue):n._decide("rejected",e._PromiseValue));else if(r){var o=!1;try{r.call(e,function(e){if(!o){o=!0;try{i._resolve(n,e,"y")}catch(e){i._reject(n,e)}}},function(e){o||(o=!0,i._reject(n,e))})}catch(e){o||this._reject(n,e)}}else n._decide("fufilled",e)}},{key:"_reject",value:function(e,t){e._decide("rejected",t)}},{key:"then",value:function(e,t){var n=this;"function"!=typeof e&&(e=null),"function"!=typeof t&&(t=null);var i=new c(function(){});return this._retrivers.push({onFufilled:e,onRejected:t,promise2:i}),setTimeout(function(){"pending"!=n._PromiseStatus&&n._onStatusChange(n._PromiseStatus)}),i}},{key:"catch",value:function(e){return this.then(null,e)}}]),c}();return a.all=function(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];if(!c)throw new Error("no argument");if(!(c instanceof Array||c instanceof Map||c instanceof Set))throw new TypeError("arg type wrong");return new a(function(n,i){var r=[],o=!1;0==c.length&&n(c),c.forEach(function(e,t){a.resolve(e).then(function(e){o||(r.push({index:t,value:e}),r.length==c.length&&n(r.sort(function(e,t){return e.index>t.index}).reduce(function(e,t){return e.push(t.value),e},[])))},function(e){o||(o=!0,i(e))})})})},a.race=function(e){if(!e)throw new Error("no argument");if(!(e instanceof Array||e instanceof Map||e instanceof Set))throw new TypeError("arg type wrong");return new a(function(n,i){var r=void 0;0==e.length&&n(e),e.forEach(function(e,t){a.resolve(e).then(function(e){r||n(r=e)},function(e){r||i(r=e)})})})},a.resolve=function(n){return n instanceof a?n:f(n)?new a(function(e){e()}).then(function(){return n}):new a(function(e,t){e(n)})},a.reject=function(n){return new a(function(e,t){t(n)})},a.dontThrow=function(){u=!0},a});
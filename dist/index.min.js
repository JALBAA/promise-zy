"use strict";var _createClass=function(){function i(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,t){return n&&i(e.prototype,n),t&&i(e,t),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function isThenable(e){return!("function"!=typeof e&&("object"!=(void 0===e?"undefined":_typeof(e))||null==e)||!e.then||"function"!=typeof e.then)}function uncaughtError(e){return new Error("Uncaught (in promise) "+e)}var Promise=function(){function u(e){var n=this;if(_classCallCheck(this,u),"function"!=typeof e)throw new Error("need 1 argument and it should be a function");this._decideLock="locked";var t=!(this._retrivers=[]),i=!1,r="pending",o=void 0;Object.defineProperties(this,{_PromiseStatus:{get:function(){return r},set:function(e){var n=this;return"locked"!=this._decideLock&&(!t&&void("pending"==r&&"pending"!=e&&(t=!0,r=e,setTimeout(function(){n._onStatusChange(e),0==n._retrivers.length&&n._PromiseStatus}))))}},_PromiseValue:{get:function(){return o},set:function(e){return"locked"!=this._decideLock&&(!i&&(i=!0,void(o=e)))}}});try{e(function(e){n._decide("fufilled",e)},function(e){n._decide("rejected",e)})}catch(e){}}return _createClass(u,[{key:"_decide",value:function(e,n){this._decideLock="unlock",this._PromiseValue=n,this._PromiseStatus=e,this._decideLock="locked"}},{key:"_onStatusChange",value:function(e){for(;0<this._retrivers.length;){var n=this._retrivers.shift();try{var t=void 0;if("fufilled"==e)t=n.onFufilled?n.onFufilled.call(void 0,this._PromiseValue):this._PromiseValue;else if("rejected"==e){if(!n.onRejected){if(this._PromiseValue instanceof Error)throw this._PromiseValue;this._reject(n.promise2,this._PromiseValue);continue}t=n.onRejected.call(void 0,this._PromiseValue)}this._resolve(n.promise2,t)}catch(e){this._reject(n.promise2,e)}}}},{key:"_resolve",value:function(n,e){var t=this;if(n==e&&this._reject(n,new TypeError("as [[Resolve]](promise, x) defined, promise === x is wrong")),e instanceof u)"pending"==e._PromiseStatus?e.then(function(e){n._decide("fufilled",e)},function(e){n._decide("rejected",e)}):"fufilled"==e._PromiseStatus?n._decide("fufilled",e._PromiseValue):"rejected"==e._PromiseStatus&&n._decide("rejected",e._PromiseValue);else if(isThenable(e)){var i=!1;try{e.then(function(e){i||(i=!0,t._resolve(n,e))},function(e){i||(i=!0,t._reject(n,e))})}catch(e){i||this._reject(n,e)}}else n._decide("fufilled",e)}},{key:"_reject",value:function(e,n){e._decide("rejected",n)}},{key:"then",value:function(e,n){var t=this;"function"!=typeof e&&(e=null),"function"!=typeof n&&(n=null);var i=new u(function(){});return this._retrivers.push({onFufilled:e,onRejected:n,promise2:i}),setTimeout(function(){"pending"!=t._PromiseStatus&&t._onStatusChange(t._PromiseStatus)}),i}},{key:"catch",value:function(e){return this.then(null,e)}}]),u}();Promise.all=function(){var u=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];if(!u)throw new Error("no argument");if(!(u instanceof Array||u instanceof Map||u instanceof Set))throw new TypeError("arg type wrong");return new Promise(function(t,i){var r=[],o=!1;0==u.length&&t(u),u.forEach(function(e,n){Promise.resolve(e).then(function(e){o||(r.push({index:n,value:e}),r.length==u.length&&t(r.sort(function(e,n){return e.index>n.index}).reduce(function(e,n){return e.push(n.value),e},[])))},function(e){o||(o=!0,i(e))})})})},Promise.race=function(e){if(!e)throw new Error("no argument");if(!(e instanceof Array||e instanceof Map||e instanceof Set))throw new TypeError("arg type wrong");return new Promise(function(t,i){var r=void 0;0==e.length&&t(e),e.forEach(function(e,n){Promise.resolve(e).then(function(e){r||t(r=e)},function(e){r||i(r=e)})})})},Promise.resolve=function(t){return t instanceof Promise?t:isThenable(t)?new Promise(function(e){e()}).then(function(){return t}):new Promise(function(e,n){e(t)})},Promise.reject=function(t){return new Promise(function(e,n){n(t)})},window.Promise=Promise;